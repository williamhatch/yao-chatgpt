/* empty css             */import{_ as k,r as m,w as y,v as x,o as i,c as a,a as t,b as c,d as r,F as I,e as D,f as S,g as d,t as h,h as _,i as w}from"./index-de90db69.js";const b={components:{},data(){return{contentDiv:[],textarea:"",right:!0,show:!1,flag:!0,closeChat:this.close,sessionId:""}},created(){let e=localStorage.getItem("session_id");if(e){this.sessionId=e;let s=localStorage.getItem(this.sessionId);s&&(this.contentDiv=JSON.parse(s))}},mounted(){this.scrollToBottom()},updated(){this.scrollToBottom()},methods:{scrollToBottom(){this.$nextTick(()=>{let e=this.$el.querySelector(".talk-content");e.scrollTop=e.scrollHeight})},clear(){this.sessionId&&(localStorage.removeItem(this.sessionId),localStorage.removeItem("session_id")),this.contentDiv=[],this.sessionId=""},async submit(){let e=this.textarea;if(e.trim().length==0)return;this.textarea="";let s=!1;this.contentDiv.length==0&&(s=!0);let n={name:"你",url:"",showAvartar:s,content:e,right:!0,time:new Date().toLocaleTimeString()};this.contentDiv.push(n),this.save();let v=await this.ask(e),l={name:"AI",url:"",showAvartar:s,content:v,right:!1,time:new Date().toLocaleTimeString()};this.contentDiv.push(l),this.save()},save(){this.sessionId&&localStorage.setItem(this.sessionId,JSON.stringify(this.contentDiv))},async ask(e){let n=await(await fetch("/api/ai/ask",{method:"POST",body:JSON.stringify({prompt:e,session_id:this.sessionId}),headers:{"Content-Type":"application/json"}})).json();return n.session_id&&(!this.sessionId||!this.sessionId.length)&&(this.sessionId=n.session_id,this.saveSession(this.sessionId)),n.message},saveSession(e){localStorage.setItem("session_id",e)},exit(){this.$emit("close",this.flag)}}},T={class:"talk"},B={class:"talk-header"},C=t("div",{class:"talk-message-title"},"智能AI对话",-1),A={class:"talk-message-clear"},N={class:"talk-content"},F={key:0},z={key:0,style:{display:"flex","justify-content":"flex-end","align-items":"center"}},O={class:"name_right"},V={style:{"font-size":"0.5rem",color:"#9b9b9b"}},j={class:"url_right"},J={class:"content_right"},L={class:"content"},K={key:1},q={key:0,style:{display:"flex","align-items":"center"}},E={class:"url_left"},H={class:"name_left"},M={style:{"font-size":"0.5rem",color:"#9b9b9b"}},P={class:"content_left"},U={class:"content"},$={class:"talk-message"},G={class:"talk-message-content"},Q={class:"talk-message-send"};function R(e,s,n,v,l,u){const g=m("a-button"),p=m("a-avatar"),f=m("a-textarea");return y((i(),a("div",T,[t("div",B,[C,t("div",A,[c(g,{type:"text",onClick:u.clear},{default:r(()=>[d("新会话")]),_:1},8,["onClick"])])]),t("div",N,[(i(!0),a(I,null,D(l.contentDiv,o=>(i(),a("div",null,[o.right?(i(),a("div",F,[o.showAvartar?(i(),a("div",z,[t("div",O,[t("p",V,h(o.time),1)]),t("div",j,[c(p,{shape:"circle",size:30},{default:r(()=>[d("你")]),_:1})])])):_("",!0),t("div",J,[t("pre",L,h(o.content),1)])])):_("",!0),o.right?_("",!0):(i(),a("div",K,[o.showAvartar?(i(),a("div",q,[t("div",E,[c(p,{shape:"circle",size:30,style:{backgroundColor:"#f56a00",verticalAlign:"middle"}},{default:r(()=>[d("AI")]),_:1})]),t("div",H,[t("p",M,h(o.time),1)])])):_("",!0),t("div",P,[t("pre",U,h(o.content),1)])]))]))),256))]),t("div",$,[t("div",G,[c(f,{ref:"textarea",id:"textinput",value:l.textarea,"onUpdate:value":s[0]||(s[0]=o=>l.textarea=o),autoSize:"",rows:1,onKeydown:s[1]||(s[1]=S(w(o=>u.submit(),["exact","prevent"]),["enter"]))},null,8,["value"])]),t("div",Q,[c(g,{type:"text",onClick:u.submit},{default:r(()=>[d("发送")]),_:1},8,["onClick"])])])],512)),[[x,l.flag]])}const Y=k(b,[["render",R]]);export{Y as default};
